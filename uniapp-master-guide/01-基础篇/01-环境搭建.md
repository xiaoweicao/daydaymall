# UniApp 环境搭建

## 1. 开发工具选择

### 方案一：HBuilderX（推荐新手）

**优点：**
- 官方开发工具，集成度高
- 内置模拟器和真机调试
- 一键运行到各个平台
- 代码提示完善

**下载地址：** https://www.dcloud.io/hbuilderx.html

### 方案二：VS Code + CLI（推荐进阶）

**优点：**
- 编辑器自由度高
- 插件生态丰富
- 支持 Git 等版本控制更方便
- 适合团队协作

**需要安装：**
- Node.js 16+
- VS Code
- 插件：uni-helper、Volar、TypeScript Vue Plugin

## 2. 环境准备

### 2.1 安装 Node.js

```bash
# 检查是否已安装
node -v
npm -v

# 推荐使用 nvm 管理 Node 版本
# Linux/Mac
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 18
nvm use 18

# Windows
# 下载安装 nvm-windows
# https://github.com/coreybutler/nvm-windows/releases
```

### 2.2 安装 Vue CLI（可选）

```bash
npm install -g @vue/cli
vue --version
```

### 2.3 安装 UniApp CLI

```bash
# 官方 CLI 工具
npm install -g @dcloudio/uvm
uvm
```

## 3. 创建第一个项目

### 3.1 使用 HBuilderX 创建

1. 打开 HBuilderX
2. 文件 → 新建 → 项目
3. 选择 uni-app
4. 选择模板：默认模板 或 Hello uni-app
5. 输入项目名称，选择目录

### 3.2 使用命令行创建（推荐）

```bash
# Vue 3 + TypeScript + Vite（推荐）
npx degit dcloudio/uni-preset-vue#vite-ts my-uniapp-project

# Vue 3 + JavaScript + Vite
npx degit dcloudio/uni-preset-vue#vite my-uniapp-project

# Vue 2 + JavaScript（旧版）
npx degit dcloudio/uni-preset-vue#vue2 my-uniapp-project
```

### 3.3 安装依赖

```bash
cd my-uniapp-project
npm install
```

## 4. 项目运行

### 4.1 运行到 H5

```bash
npm run dev:h5

# 浏览器访问
# http://localhost:5173/
```

### 4.2 运行到微信小程序

```bash
npm run dev:mp-weixin

# 1. 下载微信开发者工具
# 2. 导入项目目录下的 dist/dev/mp-weixin
# 3. 开始调试
```

### 4.3 运行到支付宝小程序

```bash
npm run dev:mp-alipay
```

### 4.4 运行到 App

```bash
# 需要 HBuilderX
npm run dev:app

# 或在 HBuilderX 中
# 运行 → 运行到手机或模拟器
```

## 5. VS Code 配置（使用 CLI 开发）

### 5.1 安装推荐插件

```json
{
  "recommendations": [
    "Vue.volar",
    "Vue.vscode-typescript-vue-plugin",
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode",
    "uni-helper.uni-helper-vscode",
    "ModyQyW.vscode-uni-helper",
    "evils.uniapp-vscode"
  ]
}
```

### 5.2 配置 settings.json

```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "[vue]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "typescript.tsdk": "node_modules/typescript/lib",
  "volar.takeOverMode.enabled": true
}
```

### 5.3 配置 .prettierrc

```json
{
  "semi": false,
  "singleQuote": true,
  "printWidth": 100,
  "trailingComma": "none",
  "arrowParens": "avoid",
  "endOfLine": "auto"
}
```

## 6. 微信开发者工具配置

### 6.1 下载安装

https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html

### 6.2 导入项目

1. 打开微信开发者工具
2. 选择小程序项目
3. 导入项目目录：`项目根目录/dist/dev/mp-weixin`
4. AppID：测试号或正式 AppID

### 6.3 配置（重要）

在微信开发者工具中：
- 设置 → 安全设置 → 服务端口：开启
- 详情 → 本地设置：
  - ✅ 不校验合法域名
  - ✅ 不校验 TLS 版本

## 7. 真机调试

### 7.1 H5 真机调试

```bash
# 获取本地 IP
ifconfig  # Mac/Linux
ipconfig  # Windows

# 手机访问
http://你的IP:5173
```

### 7.2 微信小程序真机调试

在微信开发者工具中：
- 点击 "预览"
- 手机微信扫码

### 7.3 App 真机调试

使用 HBuilderX：
- 连接手机（USB 调试模式）
- 运行 → 运行到手机或模拟器
- 选择你的设备

## 8. 常见问题

### 8.1 npm install 失败

```bash
# 使用淘宝镜像
npm config set registry https://registry.npmmirror.com

# 或使用 cnpm
npm install -g cnpm --registry=https://registry.npmmirror.com
cnpm install
```

### 8.2 微信开发者工具导入失败

- 确保导入的是 `dist/dev/mp-weixin` 目录
- 确保已运行 `npm run dev:mp-weixin`
- 检查 AppID 是否正确

### 8.3 HBuilderX 和 CLI 如何选择

| 特性 | HBuilderX | CLI |
|------|-----------|-----|
| 上手难度 | 简单 | 稍难 |
| 自定义程度 | 低 | 高 |
| 团队协作 | 一般 | 好 |
| 插件生态 | 内置 | 丰富 |
| 适合人群 | 新手 | 有经验开发者 |

**建议：** 新手用 HBuilderX 快速入门，有经验后用 CLI + VS Code

## 9. 下一步

环境搭建完成后，开始学习：
- 项目结构详解
- 基础组件使用
- 页面开发

## 10. 验证环境

创建一个简单页面测试环境是否正常：

```vue
<!-- pages/index/index.vue -->
<template>
  <view class="container">
    <text class="title">Hello UniApp!</text>
    <button @click="handleClick">点击测试</button>
  </view>
</template>

<script setup lang="ts">
const handleClick = () => {
  uni.showToast({
    title: '环境搭建成功！',
    icon: 'success'
  })
}
</script>

<style>
.container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
}

.title {
  font-size: 40rpx;
  font-weight: bold;
  margin-bottom: 40rpx;
}
</style>
```

运行后能看到页面并点击按钮弹出提示，说明环境搭建成功！🎉
